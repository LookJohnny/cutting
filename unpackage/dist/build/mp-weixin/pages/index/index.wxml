<view class="container"><view class="input-section"><view class="board-info"><text class="section-title">板材规格</text><view class="board-size-inputs"><view class="input-group"><text>长：</text><input type="digit" placeholder="长度(cm)" data-event-opts="{{[['blur',[['validateBoardSize',['$event']]]],['input',[['__set_model',['','boardLength','$event',[]]]]]]}}" value="{{boardLength}}" bindblur="__e" bindinput="__e"/><text>cm</text></view><text class="multiply-symbol">×</text><view class="input-group"><text>宽：</text><input type="digit" placeholder="宽度(cm)" data-event-opts="{{[['blur',[['validateBoardSize',['$event']]]],['input',[['__set_model',['','boardWidth','$event',[]]]]]]}}" value="{{boardWidth}}" bindblur="__e" bindinput="__e"/><text>cm</text></view><button data-event-opts="{{[['tap',[['resetBoardSize',['$event']]]]]}}" class="reset-btn" bindtap="__e">重置默认</button></view></view><view class="cut-list"><text class="section-title">裁切需求</text><block wx:for="{{cutRequests}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="cut-item"><view class="input-group"><input type="digit" placeholder="宽度(cm)" data-event-opts="{{[['input',[['__set_model',['$0','width','$event',[]],[[['cutRequests','',index]]]]]]]}}" value="{{item.width}}" bindinput="__e"/><input type="number" placeholder="数量" data-event-opts="{{[['input',[['__set_model',['$0','count','$event',[]],[[['cutRequests','',index]]]]]]]}}" value="{{item.count}}" bindinput="__e"/><block wx:if="{{$root.g0>1}}"><button data-event-opts="{{[['tap',[['deleteRequest',[index]]]]]}}" class="delete-btn" bindtap="__e">×</button></block></view></view></block><button data-event-opts="{{[['tap',[['addRequest',['$event']]]]]}}" class="add-btn" bindtap="__e">添加需求</button></view><button data-event-opts="{{[['tap',[['calculate',['$event']]]]]}}" class="calculate-btn" bindtap="__e">计算方案</button></view><block wx:if="{{$root.g1}}"><view class="result-section"><text class="section-title">裁切方案</text><view class="total-info"><text>{{"共需要 "+$root.g2+" 块板材"}}</text><text>{{"总废料率: "+wasteRate+"%"}}</text></view><scroll-view class="boards-view" scroll-y="{{true}}"><block wx:for="{{$root.l1}}" wx:for-item="board" wx:for-index="boardIndex" wx:key="boardIndex"><view class="board-item"><view class="board-header"><text class="board-title">{{"板材 "+(boardIndex+1)}}</text><text class="board-remain">{{"剩余: "+board.$orig.remain+"cm"}}</text></view><view class="board-visual-container"><view class="ruler"><block wx:for="{{12}}" wx:for-item="i" wx:for-index="__i0__" wx:key="*this"><text class="ruler-mark">{{i*10}}</text></block></view><view class="board-visual"><block wx:for="{{board.l0}}" wx:for-item="piece" wx:for-index="pieceIndex" wx:key="pieceIndex"><view class="piece" style="{{'width:'+(piece.$orig.width/boardWidth*100+'%')+';'+('background-color:'+(piece.m0)+';')}}"><text class="piece-width">{{piece.$orig.width+"cm"}}</text><view class="piece-grid"></view></view></block><block wx:if="{{board.$orig.remain>0}}"><view class="piece remain" style="{{'width:'+(board.$orig.remain/boardWidth*100+'%')+';'}}"><text class="piece-width">{{board.$orig.remain+"cm"}}</text><view class="piece-grid"></view></view></block></view></view></view></block></scroll-view></view></block><view class="history-section"><text class="section-title">历史记录</text><scroll-view class="history-list" scroll-y="{{true}}"><block wx:for="{{histories}}" wx:for-item="history" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['loadHistory',[index]]]]]}}" class="history-item" bindtap="__e"><text class="history-date">{{history.date}}</text><text class="history-board-size">{{history.boardLength+"×"+history.boardWidth+"cm"}}</text><text class="history-summary">{{history.totalBoards+"块板材 · "+history.totalPieces+"个裁片"}}</text></view></block></scroll-view></view></view>